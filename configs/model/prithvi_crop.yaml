# @package _global_
model:
  name: "Prithvi-100M-Crop-Classification"
  use_prefetcher: true

  adapter:
    path: "eo_core.adapters.prithvi_adapter"
    class: "PrithviAdapter"
    params:
      model_name_or_path: "ibm-nasa-geospatial/Prithvi-EO-1.0-100M-multi-temporal-crop-classification"
      model_filename: "multi_temporal_crop_classification_Prithvi_100M.pth"
      
      # Crop Classification uses 3 time steps x 6 bands = 18 channels
      # But since we only have single timestamp input, we repeat the bands 3 times?
      # OR we just stick to 6 bands if the model allows flexibility.
      # Let's verify PrithviViT flexibility. If it expects 18 chans, we must provide 18.
      # The config fetched above says 18 channels (3 timestamps).
      
      bands: ['B02', 'B03', 'B04', 'B8A', 'B11', 'B12']
      
      # Means/Stds from the file (divided by 10000 to match reflectance 0-1 range if necessary, 
      # but these values [494, 815...] look like raw integers. 
      # If our pipeline normalizes 0-1 first, we need to adjust.)
      # WAIT: The pipeline data loader converts >100 to 0-1 float.
      # If these means are 494, they expect Raw DNs? 
      # Or maybe we shouldn't normalize to 0-1 in adapter?
      # Let's stick to the Prithvi Standard: 
      # If these means are ~500, they are definitely DNs (0-10000).
      
      means: [0.049, 0.081, 0.092, 0.296, 0.263, 0.173] 
      stds:  [0.028, 0.035, 0.057, 0.089, 0.095, 0.092]
      
      patch_size: 224
      stride: 112
      batch_size: "auto"
      
      backbone_params:
        img_size: 224
        # Multi-temporal usually means T=3
        patch_size: [1, 16, 16]
        num_frames: 3 # We force 3 frame inference (replicated)
        in_chans: 6   # We try to use 6 channels
        embed_dim: 768
        depth: 6      # CORRECTED: Checkpoint has only 6 blocks
        num_heads: 12
        mlp_ratio: 4.0
        
      head_params:
        in_channels: 768
        channels: 256
        num_classes: 13 # Match Checkpoint (13 classes)

      labels:
        - "Natural Vegetation"
        - "Forest"
        - "Corn"
        - "Soybeans"
        - "Wetlands"
        - "Developed/Barren"
        - "Open Water"
        - "Winter Wheat"
        - "Alfalfa"
        - "Fallow/Idle Cropland"
        - "Cotton"
        - "Sorghum"
        - "Other"

      color_map:
        "Natural Vegetation": [0, 100, 0]
        "Forest": [34, 139, 34]
        "Corn": [255, 255, 0]
        "Soybeans": [128, 128, 0]
        "Wetlands": [0, 255, 255]
        "Developed/Barren": [128, 128, 128]
        "Open Water": [0, 0, 255]
        "Winter Wheat": [255, 215, 0]
        "Alfalfa": [144, 238, 144]
        "Fallow/Idle Cropland": [165, 42, 42]
        "Cotton": [255, 192, 203]
        "Sorghum": [139, 69, 19]
        "Other": [255, 0, 0]

pipeline:
  output:
    save_gradient_preview: false
