# @package _global_
pipeline:
  tiling:
    # The exact output dimensions we want per write operation (Zone of Responsibility)
    zone_of_responsibility_size: "auto" 
    
    # The context margin. Input size = ZoR + (2 * Halo)
    # Must be >= model effective receptive field / 2. 
    # For ResNet50-UNet, ~128 is safe.
    halo_size_pixels: 128
    
    # Patching strategy for inference
    patch_size: 120
    patch_stride: 120
    
    # Handling image edges
    padding_mode: "reflect"
    

  distributed:
    # Options: 'ray', 'dask', 'local'
    engine: "local"
    
    # Address for Ray head node
    address: "auto" 
    
    # Resource allocation per task
    num_gpus_per_worker: 1.0
    gpu_batch_size: "auto"
    data_loader_workers: 4
    prefetch_queue_size: 1 # Number of preprocessed chunks to keep in memory for the GPU
    writer_queue_size: 2 # Size of the queue between Inference and Writer processes

    
  output:
    save_confidence: true
    save_entropy: true
    save_gap: true
    save_probs: false
    save_gradient_preview: false # Save probability of target class (for binary models)
    save_preview: true
    preview_downscale_factor: 10
    confidence_threshold: 0.05
